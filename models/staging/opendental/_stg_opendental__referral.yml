version: 2

models:
  - name: stg_opendental__referral
    description: Staging model for referrals from OpenDental
    columns:
      - name: referral_num
        description: Primary key of the referral record
        tests:
          - unique
          - not_null

      - name: last_name
        description: Last name of the referral contact

      - name: first_name
        description: First name of the referral contact

      - name: middle_name
        description: Middle name of the referral contact

      - name: ssn
        description: Social Security Number of the referral contact

      - name: using_tin
        description: Flag indicating if using Tax Identification Number instead of SSN

      - name: national_provider_id
        description: National Provider Identifier (NPI)

      - name: business_name
        description: Business or practice name

      - name: telephone
        description: Primary telephone number

      - name: phone2
        description: Secondary telephone number

      - name: email
        description: Email address

      - name: address_line1
        description: Primary address line

      - name: address_line2
        description: Secondary address line

      - name: city
        description: City name

      - name: state
        description: State code (2 characters)

      - name: zip_code
        description: ZIP/Postal code

      - name: specialty
        description: Specialty code/identifier

      - name: title
        description: Professional title

      - name: is_doctor
        description: Flag indicating if the referral contact is a doctor

      - name: is_preferred
        description: Flag indicating if this is a preferred referral contact

      - name: is_trusted_direct
        description: Flag indicating if this is a trusted direct referral source

      - name: note
        description: General notes about the referral contact

      - name: display_note
        description: Notes for display purposes

      - name: is_hidden
        description: Flag indicating if the referral record is hidden

      - name: not_person
        description: Flag indicating if the referral is not an individual person

      - name: patient_num
        description: Foreign key to patient table
        tests:
          - relationships:
              to: ref('stg_opendental__patient')
              field: patient_id

      - name: slip
        description: Identifier for associated slip record

      - name: date_timestamp
        description: Timestamp of when the record was last updated
