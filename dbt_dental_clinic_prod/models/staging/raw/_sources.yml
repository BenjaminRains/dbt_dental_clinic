version: 2

sources:
  - name: opendental
    description: "OpenDental dental practice management system data"
    database: opendental_analytics
    schema: raw
    
    # Global settings for all tables
    loaded_at_field: "_loaded_at"
    freshness:
      warn_after: {count: 24, period: hour}
      error_after: {count: 720, period: hour}
    
    tables:
      # ETL Tracking Tables
      - name: etl_load_status
        description: "Tracks ETL load operations status"
        columns:
          - name: id
            tests:
              - unique
              - not_null
          - name: table_name
            tests:
              - not_null
          - name: extraction_status
            tests:
              - not_null
              - accepted_values:
                  values: ['pending', 'in_progress', 'completed', 'failed']
      
      - name: etl_transform_status
        description: "Tracks ETL transform operations status"
        columns:
          - name: id
            tests:
              - unique
              - not_null
          - name: table_name
            tests:
              - not_null
          - name: transformation_status
            tests:
              - not_null
              - accepted_values:
                  values: ['pending', 'in_progress', 'completed', 'failed']