version: 2

sources:
  - name: opendental
    description: "OpenDental data in PostgreSQL"
    database: opendental_analytics
    schema: raw  # Raw data from ETL pipeline
    
    # Global settings for all tables
    loaded_at_field: "_loaded_at"
    freshness:
      warn_after: {count: 24, period: hour}
      error_after: {count: 720, period: hour}
    
    tables:
      - name: document
        description: "Documents attached to patient records"
        columns:
          - name: "DocNum"
            description: "Primary key for documents"
            tests:
              - unique
              - not_null
          - name: "PatNum"
            description: "Foreign key to patient records"
          - name: "DocCategory"
            description: "Category identifier for the document"
          - name: "MountItemNum"
            description: "Reference to mounted item"
          - name: "ProvNum"
            description: "Provider identifier"
          - name: "Description"
            description: "Document description"
          - name: "FileName"
            description: "Name of the stored file"
          - name: "ToothNumbers"
            description: "Related tooth numbers"
          - name: "Note"
            description: "Additional notes"
          - name: "Signature"
            description: "Digital signature data"
          - name: "ExternalGUID"
            description: "External system identifier"
          - name: "ExternalSource"
            description: "Source system identifier"
          - name: "RawBase64"
            description: "Base64 encoded document content"
          - name: "Thumbnail"
            description: "Base64 encoded thumbnail"
          - name: "OcrResponseData"
            description: "OCR extracted text data"
          - name: "ImgType"
            description: "Image type identifier"
          - name: "IsFlipped"
            description: "Binary flag for image flip status"
          - name: "DegreesRotated"
            description: "Image rotation in degrees"
          - name: "SigIsTopaz"
            description: "Flag for Topaz signature system"
          - name: "CropX"
            description: "Crop X coordinate"
          - name: "CropY"
            description: "Crop Y coordinate"
          - name: "CropW"
            description: "Crop width"
          - name: "CropH"
            description: "Crop height"
          - name: "WindowingMin"
            description: "Minimum window value"
          - name: "WindowingMax"
            description: "Maximum window value"
          - name: "IsCropOld"
            description: "Legacy crop format flag"
          - name: "ImageCaptureType"
            description: "Method of image capture"
          - name: "PrintHeading"
            description: "Print header settings flag"
          - name: "DateCreated"
            description: "Document creation timestamp"
          - name: "DateTStamp"
            description: "Last update timestamp"

      - name: sheet
        description: "Custom forms and sheets"
        columns:
          - name: "SheetNum"
            description: "Primary key for sheets"
            tests:
              - unique
              - not_null
          - name: "PatNum"
            description: "Foreign key to patient"
          - name: "SheetDefNum"
            description: "Foreign key to sheet definition"
          - name: "DateTimeSheet"
            description: "Timestamp of sheet creation"
          - name: "InternalNote"
            description: "Internal notes for the sheet"
          - name: "IsLocked"
            description: "Flag indicating if sheet is locked"
          - name: "SignerProvNum"
            description: "Provider who signed the sheet"
          - name: "SignerType"
            description: "Type of signer"
          - name: "SignDateTime"
            description: "Timestamp of signature"
          - name: "HasMobileLayout"
            description: "Flag indicating mobile layout availability"

      - name: sheetdef
        description: "Definitions for custom sheets"
        columns:
          - name: "SheetDefNum"
            description: "Primary key for sheet definitions"
            tests:
              - unique
              - not_null
          - name: "Description"
            description: "Sheet description"
          - name: "SheetType"
            description: "Type of sheet"
          - name: "FontSize"
            description: "Default font size for the sheet"
          - name: "FontName"
            description: "Default font name for the sheet"
          - name: "Width"
            description: "Sheet width"
          - name: "Height"
            description: "Sheet height"
          - name: "IsLandscape"
            description: "Flag indicating landscape orientation"
          - name: "PageCount"
            description: "Number of pages in the sheet"
          - name: "IsMultiPage"
            description: "Flag indicating multiple pages"
          - name: "BypassGlobalLock"
            description: "Flag to bypass global locking"
          - name: "HasMobileLayout"
            description: "Flag indicating mobile layout availability"
          - name: "DateTCreated"
            description: "Creation timestamp"
          - name: "RevID"
            description: "Revision identifier"
          - name: "AutoCheckSaveImage"
            description: "Flag for automatic image saving"
          - name: "AutoCheckSaveImageDocCategory"
            description: "Document category for auto-saved images"

      - name: sheetfield
        description: "Field values for custom sheets"
        columns:
          - name: "SheetFieldNum"
            description: "Primary key for sheet fields"
            tests:
              - unique
              - not_null
          - name: "SheetNum"
            description: "Foreign key to sheet"
          - name: "SheetFieldDefNum"
            description: "Foreign key to sheet field definition"
          - name: "FieldValue"
            description: "Value stored in the field"
          - name: "FieldValueType"
            description: "Type of value stored"
          - name: "FontSize"
            description: "Font size for the field"
          - name: "FontName"
            description: "Font name for the field"
          - name: "IsFontBold"
            description: "Flag indicating if font is bold"
          - name: "XPos"
            description: "Horizontal position of field"
          - name: "YPos"
            description: "Vertical position of field"
          - name: "Width"
            description: "Width of the field"
          - name: "Height"
            description: "Height of the field"
          - name: "TextAlign"
            description: "Text alignment within field"
          - name: "ItemColor"
            description: "Color of the field item"
          - name: "IsLocked"
            description: "Flag indicating if field is locked"
          - name: "TabOrder"
            description: "Tab order for navigation"
          - name: "TabOrderMobile"
            description: "Tab order for mobile display"

      - name: sheetfielddef
        description: "Field definitions for custom sheets"
        columns:
          - name: "SheetFieldDefNum"
            description: "Primary key for sheet field definitions"
            tests:
              - unique
              - not_null
          - name: "SheetDefNum"
            description: "Foreign key to sheet definition"
          - name: "FieldType"
            description: "Type of field (text box, checkbox, signature field)"
          - name: "FieldName"
            description: "Name identifier for the field"
          - name: "FieldValue"
            description: "Default value for the field"
          - name: "FontSize"
            description: "Default font size for the field"
          - name: "FontName"
            description: "Default font name for the field"
          - name: "IsFontBold"
            description: "Flag indicating if font is bold"
          - name: "XPos"
            description: "Default horizontal position"
          - name: "YPos"
            description: "Default vertical position"
          - name: "Width"
            description: "Default width of the field"
          - name: "Height"
            description: "Default height of the field"
          - name: "GrowthBehavior"
            description: "Growth behavior when content is added"
          - name: "RadioButtonValue"
            description: "Default value for radio buttons"
          - name: "RadioButtonGroup"
            description: "Group identifier for related radio buttons"
          - name: "IsRequired"
            description: "Flag indicating if field is required"
          - name: "TabOrder"
            description: "Default tab navigation order"
          - name: "ReportableName"
            description: "Name used for reporting purposes"
          - name: "TextAlign"
            description: "Default text alignment"
          - name: "IsPaymentOption"
            description: "Flag for payment option fields"
          - name: "ItemColor"
            description: "Default color of the field"
          - name: "IsLocked"
            description: "Flag indicating if field is locked"
          - name: "TabOrderMobile"
            description: "Tab order for mobile display"
          - name: "UiLabelMobile"
            description: "Label for mobile display"
          - name: "UiLabelMobileRadioButton"
            description: "Mobile-specific label for radio buttons"
          - name: "LayoutMode"
            description: "Field layout mode"
          - name: "Language"
            description: "Language setting for the field"
          - name: "CanElectronicallySign"
            description: "Flag for electronic signature capability"
          - name: "IsSigProvRestricted"
            description: "Flag for provider-restricted signatures"
